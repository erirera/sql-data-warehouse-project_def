SELECT
	CST_ID,
	COUNT(*)
FROM -- to join three tables and check for duplicates
	(
		SELECT
			CI.CST_ID,
			CI.CST_KEY,
			CI.CST_FIRSTNAME,
			CI.CST_LASTNAME,
			CI.CST_MARITAL_STATUS,
			CI.CST_GNDR,
			CI.CST_CREATE_DATE,
			CA.BDATE,
			CA.GEN,
			LA.CNTRY
		FROM
			SILVER.CRM_CUST_INFO CI
			LEFT JOIN SILVER.ERP_CUST_AZ12 CA ON CI.CST_KEY = CA.CID
			LEFT JOIN SILVER.ERP_LOC_A101 LA ON CI.CST_KEY = LA.CID
	) T
GROUP BY
	CST_ID
HAVING
	COUNT(*) > 1;
