/*
==========================================
Create database and schemas
==========================================
Script Purpose:
This script creates a new database named ‘DataWarehous’ after checking if it already exists. If the database exists, it is dropped and recreated. Additionally, the script sets up three schemas within the databse: ‘bronze’, ‘silver’, and ‘gold’.

Warning:
Running this script will drop the entire ‘DataWarehouse’ database if it exists. All data in the database will be permanently deleted. Proceed with caution and ensure you have proper backups before running this script.
*/

-- Database: DataWarehouse
-- DROP DATABASE IF EXISTS "DataWarehouse";

CREATE DATABASE "DataWarehouse"
    WITH
    OWNER = postgres
    ENCODING = 'UTF8'
    LC_COLLATE = 'English_United States.1252'
    LC_CTYPE = 'English_United States.1252'
    LOCALE_PROVIDER = 'libc'
    TABLESPACE = pg_default
    CONNECTION LIMIT = -1
    IS_TEMPLATE = False;

-- SCHEMA: bronze
-- DROP SCHEMA IF EXISTS bronze ;
CREATE SCHEMA IF NOT EXISTS bronze
    AUTHORIZATION postgres;

-- SCHEMA: silver
-- DROP SCHEMA IF EXISTS silver ;
CREATE SCHEMA IF NOT EXISTS silver
    AUTHORIZATION postgres;

-- SCHEMA: gold
-- DROP SCHEMA IF EXISTS gold ;
CREATE SCHEMA IF NOT EXISTS gold
    AUTHORIZATION postgres;

CREATE TABLE IF NOT EXISTS bronze.cust_info (
    cst_id INTEGER PRIMARY KEY,
    cst_key VARCHAR(50) NOT NULL,
    cst_firstname VARCHAR(50),
    cst_lastname VARCHAR(50),
    cst_marital_status CHAR(1) CHECK (cst_marital_status IN ('S', 'M')),
    cst_gndr CHAR(1) CHECK (cst_gndr IN ('M', 'F')),
    cst_create_date DATE
);

